<!DOCTYPE html>

<head>
    <meta charset='utf8' />
    <link rel="stylesheet" type="text/css" href="style/home.css">
    <link rel="stylesheet" type="text/css" href="style/map.css">
    <script src="libraries/GSAP/gsap.min.js"></script>
    <script src="libraries/GSAP/Draggable.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="assets/fontawesome/css/all.css">
</head>

<body>
<div style="position: absolute; top: 10px; left: 50%; transform: translateX(-50%); z-index: 3; background: #EADCC3A3; padding: 10px 30px; border-radius: 20px;">
        <check if="{{ @SESSION.username=='UNSET' }}">
            <true>
                <p>login to write notes</p>
            </true>
            <false>
                <p>logged in as {{@SESSION.username}}</p>
            </false>
        </check>
    </div>
    <div class="navbar-layout">
        <div class="navbar-container" style="height:100vh; pointer-events: all;">
            <div class="navbar">
                <div class="navbar-section">
                    <a href="{{ @BASE }}/"><img class="logo" src="img/icons/Mini Logo.png"></a>
                </div>
                <div class="navbar-section">

                    <ul>
                        <li><a href="{{ @BASE }}/"><img class="logo" src="img/icons/Home_Icon.svg"></a></li>
                        <span></span>
                        <li>
                            <check if="{{ @SESSION.username=='UNSET' }}">
                                <false>
                                    <a href="{{@BASE}}/acc"><img src="img/icons/Account_Icon.svg" class="logo"></a>
                                </false>
                                <true>
                                    <a href="{{ @BASE }}/login"><img src="img/icons/Account_Icon.svg" class="logo"></a>
                                </true>
                            </check>
                        </li>
                        <span></span>
                        <li><a><img onclick="openReportProblem()" class="logo" src="img/icons/Warning_Icon.svg"></a>
                        </li>
                    </ul>
                </div>
                <div class="navbar-section">
                    <img id="show-tutorial-button" class="logo" src="img/icons/Info_Icon.svg">
                </div>
                <div class="navbar-section">
                    <ul>
                        <li><a><img class="logo" src="img/icons/WriteNote_Icon.svg" onclick="enterEditMode()"></a>
                        </li>
                        <span></span>
                        <li id="filter-toggle"><a><img class="logo" src="img/icons/Filter_Icon.svg"></a></li>
                    </ul>
                </div>
                <div class="search-container" style="align-self: flex-start">
                    <div class="navbar-section search">
                        <img class="logo" src="img/icons/Search_Icon.svg">
                        <input class="location-input" type="text" onkeyup="showHint(this.value)"
                            placeholder="Search Location">
                    </div>
                    <div id="search-results">
                        <ul id="textHint" style="padding: 16px"></ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="navbar-container" style="height:100vh">
            <div class="navbar" style="align-items: flex-start; gap:16px">
                <div class="info-section">
                    <div class="info">
                        <div class="info-text">
                            <p style="color: #FF0090; font-weight: bold">Welcome to Thirdplace!</p>
                            <img src="img/icons/Close-icon.svg" class="skip" alt="Skip">
                        </div>
                        <div class="info-button">
                            <button class="next">next</button>
                        </div>
                    </div>
                </div>
                <div class="info-section">
                    <ul>
                        <li class="info">
                            <p style="color: #FF0090;">click here to return to the homepage.</p>
                            <img src="img/icons/Close-icon.svg" class="skip" alt="Skip">
                            <button class="next">next</button>

                        </li>
                        <li class="info">

                            <p style="color: #FF0090;">account and settings</p>
                            <p style="color: #FF0090;">you can access your account page
                                from here and make any changes you
                                want.</p>
                            <img src="img/icons/Close-icon.svg" class="skip" alt="Skip">
                            <button class="next">next</button>
                        </li>
                        <li class="info">

                            <p style="color: #FF0090;">report a problem</p>
                            <img src="img/icons/Close-icon.svg" class="skip" alt="Skip">
                            <button class="next">next</button>
                        </li>
                    </ul>
                </div>
                <div class="info-section">
                    <div class="info">
                        <p style="color: #FF0090;">how to use</p>
                        <p style="color: #FF0090;">you can re-take the tutorial
                            at any time by clicking the question
                            mark (?) button here.</p>
                        <img src="img/icons/Close-icon.svg" class="skip" alt="Skip">
                        <button class="next">next</button>
                    </div>
                </div>
                <div class="info-section">
                    <ul id="filters-on">
                        <li class="info">
                            <p style="color: #FF0090;">custom location</p>
                            <p style="color: #FF0090;">or click here to add your note
                                in a custom location anywhere on
                                the map.</p>
                            <img src="img/icons/Close-icon.svg" class="skip" alt="Skip">
                            <button class="next">next</button>
                        </li>
                        <li class="info">
                            <p style="color: #FF0090;">filter the locations</p>
                            <img src="img/icons/Close-icon.svg" class="skip" alt="Skip">
                            <button class="next">next</button>
                        </li>
                    </ul>
                    <div class="filters" id="filters">
                        <label><input type="checkbox" value="park" class="filter">park</label>
                        <label><input type="checkbox" value="restaurant" class="filter">restaurant</label>
                        <label><input type="checkbox" value="museum" class="filter">museum</label>
                        <label><input type="checkbox" value="cafe" class="filter">cafe</label>
                        <label><input type="checkbox" value="bar" class="filter">bar</label>
                        <label><input type="checkbox" value="landmark" class="filter">landmark</label>
                        <label><input type="checkbox" value="street" class="filter">street</label>
                        <label><input type="checkbox" value="other" class="filter">other</label>
                    </div>
                </div>
                <div class="info-section" style="align-self: flex-start">
                    <div class="info">
                        <p style="color: #FF0090;">search our database of popular
                            locations in your city here.</p>
                        <img src="img/icons/Close-icon.svg" class="skip" alt="Skip">
                        <button class="next">next</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div id="map-container">
        <div class="map" id="map">
            <div class="pin-parent">
                <repeat group="{{ @thirdplacesData }}" value="{{ @place }}">
                    <div class="pin {{@place.type}}"
                        style="left: {{ @place.position_x - 10 }}px; top: {{ @place.position_y - 15 }}px;"
                        onclick="openModal('{{@place.name}}')">
                        <!--                add amount of notes in a place-->
                        <p class="pin-number">{{@place.note_count}}</p>
                    </div>
                </repeat>
            </div>
        </div>
    </div>

    <div class="modal" id="modal-notes">
        <div class="modal-header">
            <h3 id="modal-note-thirdplace-name">Placeholder</h3>
            <button class="close-btn" onclick="closeModal()"></button>
        </div>
        <div class="modal-content">
            <button class="floating-btn" onclick="openWriteNoteModal()">Leave a note</button>
            <div class="notes-container">
            </div>
        </div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-header">
            <h3 id="modal-thirdplace-name">Placeholder</h3>
            <button class="close-btn" onclick="closeModal()"></button>
        </div>
        <div class="modal-content">
            <check if="{{@SESSION.username!= 'UNSET'}}">
                <true>
                    <form id="notes" name="notes" method="post" action="{{@BASE}}/submitReason"
                        >
                        <textarea class="input-field" id="reason" name="reason" style="resize:none"
                            placeholder="Write your reason here..." required maxlength="220"></textarea>
                        <div style="margin:16px 0">
                            <label for="stay-anon-check">Stay Anonymous</label>
                            <input type="checkbox" class="check" id="stay-anon-check" name="isAnonymous" value="1">
                        </div>
                        <input type="hidden" id="thirdplace_name" name="thirdplace">
                        <button type="submit" class="submit-btn" value="reason">Submit</button>
                        <p class="errorNote"> {{ @error }} </p>
                    </form>
                </true>
                <false>
                    <p>Log in to leave a note</p>
                </false>
            </check>
        </div>
    </div>

    <div class="modal" id="modal-location">
        <div class="modal-header">
            <button class="close-btn" onclick="closeNewLocationModal()"></button>
        </div>
        <check if="{{ @SESSION.username=='UNSET' }}">
            <false>
                <form name="notes" id="new-location-notes" method="post" action="{{@BASE}}/submitReasonAndLocation" style="display: grid;grid-template-columns: repeat(2, 1fr);gap:10px;">

                    <div class="modal-content-note">
                        <p style="font-size: 24px">add note</p>
                        <p style="font-size: 18px">logged in as {{@SESSION.username}}</p>
                        <div style="background-color: white;display: flex;flex-direction: column;gap: 10px; padding: 10px; border-radius: 20px">
                            <p>{{ @SESSION.username }}</p>
                            <div>
                                <label for="stay-anon-check-2">Stay Anonymous</label>
                                <input type="checkbox" class="check" id="stay-anon-check-2" name="isAnonymous" value="1">
                            </div>
                            <textarea class="input-field" type="text" name="reason" placeholder="Write your reason here..."
                                      required maxlength="220"></textarea>
                            <input type="text" name="location" placeholder="Enter the location name..." required>
                            <input type="hidden" id="x-coord" name="position_x">
                            <input type="hidden" id="y-coord" name="position_y">
                            <select name="thirdplace_type">
                                <option value="park">Park</option>
                                <option value="restaurant">Restaurant</option>
                                <option value="museum">Museum</option>
                                <option value="cafe">Cafe</option>
                                <option value="bar">Bar</option>
                                <option value="landmark">Landmark</option>
                                <option value="street">Street</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <button type="submit" class="submit-btn" value="reason">Submit</button>
                    </div>
                    <div>
                        <p>Colours (maybe)</p>
                        <div>
                            <div>
                                <ul style="padding: 16px"></ul>
                            </div>
                            <input class="location-input" type="text" onkeyup="showHint(this.value)"
                                    placeholder="Search Location">
                        </div>
                    </div>
                </form>
            </false>
            <true>
                <p style="top: 100px;position: fixed;">Login to leave a note</p>
            </true>
        </check>
    </div>

    <div class="modal" id="report-problem">
        <div class="modal-header">
            <h3>Something wrong?</h3>
            <p>Let us know the problem and we will try to sort it out.</p>
            <button class="close-btn" onclick="closeReportProblem()"></button>
        </div>
        <div class="modal-content">
            <form style="padding: 16px 0" method="post" action="{{@BASE}}/reportAProblem" id="report-problem-form">
                <label for="report-message"></label>
                <textarea id="report-message" name="content" required></textarea>
                <button type="submit">Submit</button>
            </form>
        </div>
    </div>

    <div id="popup" class="popup">
        <div class="popup-content">
            <span id="popup-close" class="popup-close">&times;</span>
            <p id="popup-message"></p>
        </div>
    </div>


    <div class="overlay">
    </div>
</body>
<script src="javascript/map.js"></script>
<script src="javascript/map-nav.js"></script>
<script src="javascript/map-controls.js"></script>

</html>